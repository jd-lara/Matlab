function f=func(x)
% These are the power flow equations of a 16 bus power system.

Vs=1;
V=[1.035 1.05];
Pg=zeros(1,16);  
Qg=zeros(1,16);  
Pg(3)=110/100;
Pg(9)=220/100;
Pl=[0 0 10 0 75 0 90 0 15 0 0 0 50 35 0 150]/100;
Ql=[0 0 55 0 15 0 20 0  4 0 0 0  2  3 0  20]/100;

% Slack bus
Pg1=x(1);
Qg1=x(2);
V1=Vs;
d1=0;
V2=x(3);
d2=x(4);
% PV bus
Qg3=x(5);
d3=x(6);
V3=V(1);
V4=x(7);
d4=x(8);
V5=x(9);
d5=x(10);
V6=x(11);
d6=x(12);
V7=x(13);
d7=x(14);
V8=x(15);
d8=x(16);
% PV bus
Qg9=x(17);
d9=x(18);
V9=V(2);
V10=x(19);
d10=x(20);
V11=x(21);
d11=x(22);
V12=x(23);
d12=x(24);
V13=x(25);
d13=x(26);
V14=x(27);
d14=x(28);
V15=x(29);
d15=x(30);
V16=x(31);
d16=x(32);


f(1)=Pg1-Pl(1)-real((V1*cos(d1)+1.*i*V1*sin(d1))*((2.8289+28.289*i)*(V1*cos(d1)-1.*i*V1*sin(d1))+(-2.8289-28.289*i)*(V2*cos(d2)-1.*i*V2*sin(d2))));
f(2)=Qg1-Ql(1)-imag((V1*cos(d1)+1.*i*V1*sin(d1))*((2.8289+28.289*i)*(V1*cos(d1)-1.*i*V1*sin(d1))+(-2.8289-28.289*i)*(V2*cos(d2)-1.*i*V2*sin(d2))));
f(3)=Pg(2)-Pl(2)-real((V2*cos(d2)+1.*i*V2*sin(d2))*((-2.8289-28.289*i)*(V1*cos(d1)-1.*i*V1*sin(d1))+(9.4767+80.422*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-2.0699-10.973*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-2.0699-10.973*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(-2.3062-27.930*i)*(V15*cos(d15)-1.*i*V15*sin(d15))));
f(4)=Qg(2)-Ql(2)-imag((V2*cos(d2)+1.*i*V2*sin(d2))*((-2.8289-28.289*i)*(V1*cos(d1)-1.*i*V1*sin(d1))+(9.4767+80.422*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-2.0699-10.973*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-2.0699-10.973*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(-2.3062-27.930*i)*(V15*cos(d15)-1.*i*V15*sin(d15))));
f(5)=Pg(3)-Pl(3)-real((V3*cos(d3)+1.*i*V3*sin(d3))*((2.5389+25.723*i)*(V3*cos(d3)-1.*i*V3*sin(d3))+(-2.5389-25.723*i)*(V4*cos(d4)-1.*i*V4*sin(d4))));
f(6)=Qg3-Ql(3)-imag((V3*cos(d3)+1.*i*V3*sin(d3))*((2.5389+25.723*i)*(V3*cos(d3)-1.*i*V3*sin(d3))+(-2.5389-25.723*i)*(V4*cos(d4)-1.*i*V4*sin(d4))));
f(7)=Pg(4)-Pl(4)-real((V4*cos(d4)+1.*i*V4*sin(d4))*((-2.0699-10.973*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-2.5389-25.723*i)*(V3*cos(d3)-1.*i*V3*sin(d3))+(9.8272+63.982*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-5.2184-27.416*i)*(V6*cos(d6)-1.*i*V6*sin(d6))));
f(8)=Qg(4)-Ql(4)-imag((V4*cos(d4)+1.*i*V4*sin(d4))*((-2.0699-10.973*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-2.5389-25.723*i)*(V3*cos(d3)-1.*i*V3*sin(d3))+(9.8272+63.982*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-5.2184-27.416*i)*(V6*cos(d6)-1.*i*V6*sin(d6))));
f(9)=Pg(5)-Pl(5)-real((V5*cos(d5)+1.*i*V5*sin(d5))*((4.8561+45.207*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(-.97601-23.941*i)*(V6*cos(d6)-1.*i*V6*sin(d6))+(-3.8801-21.270*i)*(V7*cos(d7)-1.*i*V7*sin(d7))));
f(10)=Qg(5)-Ql(5)-imag((V5*cos(d5)+1.*i*V5*sin(d5))*((4.8561+45.207*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(-.97601-23.941*i)*(V6*cos(d6)-1.*i*V6*sin(d6))+(-3.8801-21.270*i)*(V7*cos(d7)-1.*i*V7*sin(d7))));
f(11)=Pg(6)-Pl(6)-real((V6*cos(d6)+1.*i*V6*sin(d6))*((-5.2184-27.416*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-.97601-23.941*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(6.1944+51.320*i)*(V6*cos(d6)-1.*i*V6*sin(d6))));
f(12)=Qg(6)-Ql(6)-imag((V6*cos(d6)+1.*i*V6*sin(d6))*((-5.2184-27.416*i)*(V4*cos(d4)-1.*i*V4*sin(d4))+(-.97601-23.941*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(6.1944+51.320*i)*(V6*cos(d6)-1.*i*V6*sin(d6))));
f(13)=Pg(7)-Pl(7)-real((V7*cos(d7)+1.*i*V7*sin(d7))*((-3.8801-21.270*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(4.8561+45.207*i)*(V7*cos(d7)-1.*i*V7*sin(d7))+(-.97601-23.941*i)*(V8*cos(d8)-1.*i*V8*sin(d8))));
f(14)=Qg(7)-Ql(7)-imag((V7*cos(d7)+1.*i*V7*sin(d7))*((-3.8801-21.270*i)*(V5*cos(d5)-1.*i*V5*sin(d5))+(4.8561+45.207*i)*(V7*cos(d7)-1.*i*V7*sin(d7))+(-.97601-23.941*i)*(V8*cos(d8)-1.*i*V8*sin(d8))));
f(15)=Pg(8)-Pl(8)-real((V8*cos(d8)+1.*i*V8*sin(d8))*((-.97601-23.941*i)*(V7*cos(d7)-1.*i*V7*sin(d7))+(6.1944+51.320*i)*(V8*cos(d8)-1.*i*V8*sin(d8))+(-5.2184-27.416*i)*(V10*cos(d10)-1.*i*V10*sin(d10))));
f(16)=Qg(8)-Ql(8)-imag((V8*cos(d8)+1.*i*V8*sin(d8))*((-.97601-23.941*i)*(V7*cos(d7)-1.*i*V7*sin(d7))+(6.1944+51.320*i)*(V8*cos(d8)-1.*i*V8*sin(d8))+(-5.2184-27.416*i)*(V10*cos(d10)-1.*i*V10*sin(d10))));
f(17)=Pg(9)-Pl(9)-real((V9*cos(d9)+1.*i*V9*sin(d9))*((2.0781+41.563*i)*(V9*cos(d9)-1.*i*V9*sin(d9))+(-2.0781-41.563*i)*(V10*cos(d10)-1.*i*V10*sin(d10))));
f(18)=Qg9-Ql(9)-imag((V9*cos(d9)+1.*i*V9*sin(d9))*((2.0781+41.563*i)*(V9*cos(d9)-1.*i*V9*sin(d9))+(-2.0781-41.563*i)*(V10*cos(d10)-1.*i*V10*sin(d10))));
f(19)=Pg(10)-Pl(10)-real((V10*cos(d10)+1.*i*V10*sin(d10))*((-5.2184-27.416*i)*(V8*cos(d8)-1.*i*V8*sin(d8))+(-2.0781-41.563*i)*(V9*cos(d9)-1.*i*V9*sin(d9))+(10.759+87.169*i)*(V10*cos(d10)-1.*i*V10*sin(d10))+(-3.4628-18.284*i)*(V11*cos(d11)-1.*i*V11*sin(d11))));
f(20)=Qg(10)-Ql(10)-imag((V10*cos(d10)+1.*i*V10*sin(d10))*((-5.2184-27.416*i)*(V8*cos(d8)-1.*i*V8*sin(d8))+(-2.0781-41.563*i)*(V9*cos(d9)-1.*i*V9*sin(d9))+(10.759+87.169*i)*(V10*cos(d10)-1.*i*V10*sin(d10))+(-3.4628-18.284*i)*(V11*cos(d11)-1.*i*V11*sin(d11))));
f(21)=Pg(11)-Pl(11)-real((V11*cos(d11)+1.*i*V11*sin(d11))*((-2.0699-10.973*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-3.4628-18.284*i)*(V10*cos(d10)-1.*i*V10*sin(d10))+(10.751+56.486*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(-5.2184-27.416*i)*(V12*cos(d12)-1.*i*V12*sin(d12))));
f(22)=Qg(11)-Ql(11)-imag((V11*cos(d11)+1.*i*V11*sin(d11))*((-2.0699-10.973*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(-3.4628-18.284*i)*(V10*cos(d10)-1.*i*V10*sin(d10))+(10.751+56.486*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(-5.2184-27.416*i)*(V12*cos(d12)-1.*i*V12*sin(d12))));
f(23)=Pg(12)-Pl(12)-real((V12*cos(d12)+1.*i*V12*sin(d12))*((-5.2184-27.416*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(6.4230+51.299*i)*(V12*cos(d12)-1.*i*V12*sin(d12))+(-1.1752-23.337*i)*(V13*cos(d13)-1.*i*V13*sin(d13))));
f(24)=Qg(12)-Ql(12)-imag((V12*cos(d12)+1.*i*V12*sin(d12))*((-5.2184-27.416*i)*(V11*cos(d11)-1.*i*V11*sin(d11))+(6.4230+51.299*i)*(V12*cos(d12)-1.*i*V12*sin(d12))+(-1.1752-23.337*i)*(V13*cos(d13)-1.*i*V13*sin(d13))));
f(25)=Pg(13)-Pl(13)-real((V13*cos(d13)+1.*i*V13*sin(d13))*((-1.1752-23.337*i)*(V12*cos(d12)-1.*i*V12*sin(d12))+(2.6722+27.958*i)*(V13*cos(d13)-1.*i*V13*sin(d13))+(-1.5256-5.1918*i)*(V14*cos(d14)-1.*i*V14*sin(d14))));
f(26)=Qg(13)-Ql(13)-imag((V13*cos(d13)+1.*i*V13*sin(d13))*((-1.1752-23.337*i)*(V12*cos(d12)-1.*i*V12*sin(d12))+(2.6722+27.958*i)*(V13*cos(d13)-1.*i*V13*sin(d13))+(-1.5256-5.1918*i)*(V14*cos(d14)-1.*i*V14*sin(d14))));
f(27)=Pg(14)-Pl(14)-real((V14*cos(d14)+1.*i*V14*sin(d14))*((-1.5256-5.1918*i)*(V13*cos(d13)-1.*i*V13*sin(d13))+(1.5256+5.1900*i)*(V14*cos(d14)-1.*i*V14*sin(d14))));
f(28)=Qg(14)-Ql(14)-imag((V14*cos(d14)+1.*i*V14*sin(d14))*((-1.5256-5.1918*i)*(V13*cos(d13)-1.*i*V13*sin(d13))+(1.5256+5.1900*i)*(V14*cos(d14)-1.*i*V14*sin(d14))));
f(29)=Pg(15)-Pl(15)-real((V15*cos(d15)+1.*i*V15*sin(d15))*((-2.3062-27.930*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(3.2840+32.045*i)*(V15*cos(d15)-1.*i*V15*sin(d15))+(-1.1634-6.3753*i)*(V16*cos(d16)-1.*i*V16*sin(d16))));
f(30)=Qg(15)-Ql(15)-imag((V15*cos(d15)+1.*i*V15*sin(d15))*((-2.3062-27.930*i)*(V2*cos(d2)-1.*i*V2*sin(d2))+(3.2840+32.045*i)*(V15*cos(d15)-1.*i*V15*sin(d15))+(-1.1634-6.3753*i)*(V16*cos(d16)-1.*i*V16*sin(d16))));
f(31)=Pg(16)-Pl(16)-real((V16*cos(d16)+1.*i*V16*sin(d16))*((-1.1634-6.3753*i)*(V15*cos(d15)-1.*i*V15*sin(d15))+(1.1634+6.3618*i)*(V16*cos(d16)-1.*i*V16*sin(d16))));
f(32)=Qg(16)-Ql(16)-imag((V16*cos(d16)+1.*i*V16*sin(d16))*((-1.1634-6.3753*i)*(V15*cos(d15)-1.*i*V15*sin(d15))+(1.1634+6.3618*i)*(V16*cos(d16)-1.*i*V16*sin(d16))));
